# 性能測定

1. コンポーネントが大量にある状態でDIコンテナの初期化を行う
1. マルチスレッドで、DIコンテナからコンポーネントを取得する

## 初期化

大量のコンポーネントが存在するプロジェクトで、DIコンテナの初期化が実用的な時間で完了すること。

### 使用クラス

- com.nablarch.framework.initialize.InitializationTester

#### コンポーネントを生成するクラス

- GeneratorMain (src/test/java)
- GeneratorInjectionMain (src/test/java)


### 結果

#### ネストしないオブジェクト群の生成

インジェクトをしないコンポーネントを用意して、DIコンテナを初期化

|  個数 | 時間   |
|-------|--------|
|    10 | 381ms  |
|   100 | 1227ms |
|  1000 | 1657ms |
| 10000 | 6456ms |


#### ネストしたオブジェクト群の生成

3つのプロパティにインジェクションを行うコンポーネントを用意して、DIコンテナを初期化


|  個数 | 時間   |
|-------|--------|
|    10 | 459ms  |
|   100 | 1198ms |
|  1000 | 1605ms |
| 10000 | 6704ms |


コンポーネントが増えても性能の劣化はない。



## マルチスレッド

マルチスレッド下で同時にDIコンテナにアクセスしても、極端な性能劣化が起こらないこと。

### 使用クラス

- com.nablarch.framework.multithread.MultiThreadTester

### テスト内容

以下の2ケースを比較する。
- 10スレッドで、1スレッド辺り100万回、DIコンテナからオブジェクトを取得する。
- 1スレッドで1000万回、DIコンテナからオブジェクトを取得する。

### 結果

| スレッド数 | 1スレッドあたりの取得回数 | 時間   |
|------------|---------------------------|--------|
| 10スレッド | 100万回                   | 1826ms |
| 1スレッド  | 1000万回                  | 1398ms |


マルチスレッド下でも大きな性能劣化は発生していない。
